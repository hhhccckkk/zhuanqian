package com.hck.getmoney.ui;import org.json.JSONObject;import android.os.Bundle;import android.view.View;import android.widget.Button;import android.widget.TextView;import com.dlnetwork.DevInit;import com.dlnetwork.GetTotalMoneyListener;import com.dlnetwork.SetTotalMoneyListener;import com.dlnetwork.SpendMoneyListener;import com.hck.getmoney.data.Data;import com.hck.getmoney.data.HttpUrls;import com.hck.getmoney.net.JsonHttpResponseHandler;import com.hck.getmoney.net.RequestParams;import com.hck.getmoney.util.HttpUtil;import com.hck.getmoney.widget.AlertDialogs;import com.hck.getmoney.widget.PDialog;import com.hck.getmoney.widget.Toasts;import com.hck.kedouzq.R;/** *  * @author *  */public class DLActivity extends BaseActivity implements GetTotalMoneyListener,		SetTotalMoneyListener, SpendMoneyListener {	private boolean isFirst = true;	private int num;	private String content;	private int point;	private TextView nameTextView, contenTextView;	private int kid;	Button button;	private int cishu = 0;	@Override	protected void onCreate(Bundle savedInstanceState) {		super.onCreate(savedInstanceState);		initDL();		setContentView(R.layout.activity_play_dl);		initView();		kid = getIntent().getIntExtra("kid", 0);		num = getIntent().getIntExtra("num", 5);		content = getIntent().getStringExtra("neirong");		initDate();	}	public void back(View view) {		finish();	}	private void initView() {		nameTextView = (TextView) findViewById(R.id.play_dl_name);		contenTextView = (TextView) findViewById(R.id.play_dl_content);		button = (Button) findViewById(R.id.title_bt_left);		button.setVisibility(View.VISIBLE);	}	private void initDate() {		nameTextView.setText("本区每天限制下载试用" + num + "个软件");		contenTextView.setText(content);	}	private void initDL() { // 初始化点乐广告		try {			DevInit.initGoogleContext(this, "501b3875cc261cbc25d5244f5b73b03a");		} catch (Exception e) {			Toasts.toast(this, "初始化失败 请重试");		}		}	public void startGetMoney(View view) {		showDL();	}	private void showDL() { // 展示点乐积分墙		try {			DevInit.showOffers(this);		} catch (Exception e) {			Toasts.toast(this, "打开任务失败 请重试");		}	}	private void getMoney() { // 点乐sdk，获取积分		try {			DevInit.getTotalMoney(this, this);		} catch (Exception e) {			Toasts.toast(this, "获取金币失败 请检查您的网络");		}	}	@Override	public void getTotalMoneyFailed(String arg0) {	}	@Override	public void getTotalMoneySuccessed(String arg0, long arg1) {		try {			point = 0;			// 保存数据			if (arg1 > 1) {				point = (int) arg1;				savePoint();				DevInit.spendMoney(this, (int) arg1, this);			}		} catch (Exception e) {		}	}	@Override	public void setTotalMoneyFailed(String arg0) {		Toasts.toast(this, "初始化数据失败，请重试");	}	@Override	public void setTotalMoneySuccessed(String arg0, long arg1) {	}	@Override	protected void onResume() {		super.onResume();		getMoney();	}	@Override	public void spendMoneyFailed(String arg0) {		try {			if (cishu > 3) {				return;			}			DevInit.spendMoney(this, (int) point, this);			cishu++;		} catch (Exception e) {		}	}	@Override	public void spendMoneySuccess(long arg0) {	}	private void savePoint() {		point = hashYQM(point);		PDialog.showDialog(this, "正在为您增加金币", "请稍等");		params = new RequestParams();		params.put("kindid", kid + "");		params.put("num", num + "");		params.put("type", "点乐");		params.put("uid", Data.userBean.getId() + "");		params.put("money", point + "");		HttpUtil.getHttpUtil().get(HttpUrls.addMoneyP, params,				new JsonHttpResponseHandler() {					@Override					public void onFinish(String url) {						super.onFinish(url);						PDialog.hidenDialog();					}					@Override					public void onFailure(Throwable error, String content) {						super.onFailure(error, content);						Toasts.toast(DLActivity.this, "网络异常 增加蝌蚪币失败 ");					}					@Override					public void onSuccess(int statusCode, JSONObject response) {						super.onSuccess(statusCode, response);						try {							isOk = response.getBoolean("isok");							if (isOk) {								AlertDialogs.alert(DLActivity.this, "获取金币成功",										nt, false, null, 0);								Data.userBean.setAllKeDouBi(Data.userBean										.getAllKeDouBi() + point);							} else {								Toasts.toast(DLActivity.this, "网络异常 增加金币失败 ");							}						} catch (Exception e) {							Toasts.toast(DLActivity.this, "网络异常 增加金币失败 ");						}					}				});	}}