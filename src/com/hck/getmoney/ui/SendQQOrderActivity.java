package com.hck.getmoney.ui;import org.json.JSONException;import org.json.JSONObject;import android.os.Bundle;import android.text.TextUtils;import android.view.View;import android.widget.EditText;import android.widget.TextView;import com.hck.kedouzq.R;import com.hck.getmoney.data.Data;import com.hck.getmoney.data.HttpUrls;import com.hck.getmoney.net.JsonHttpResponseHandler;import com.hck.getmoney.net.RequestParams;import com.hck.getmoney.util.HttpUtil;import com.hck.getmoney.util.MyPreferences;import com.hck.getmoney.util.MyTools;import com.hck.getmoney.widget.AlertDialogs;import com.hck.getmoney.widget.PDialog;import com.hck.getmoney.widget.Toasts;public class SendQQOrderActivity extends BaseActivity implements BaseMethod ,BaseAlert{	private int type;	private TextView titleTextView;	private EditText num1tEditText, num2tEditText;	private int num1;	private String qqString;	private int canGetMoney;	private String qqString2;	@Override	protected void onCreate(Bundle savedInstanceState) {		super.onCreate(savedInstanceState);		setContentView(R.layout.activity_sendorder);		initDatas();		initViews();		setListener();		getData();	}	public void sendOrder(View view) {		String num3 = num1tEditText.getText().toString();		qqString = num2tEditText.getText().toString();		if (MyTools.isNull(num3)) {			Toasts.toast(this, "兑换数量不能为空");			return;		}		if (MyTools.isNull(qqString)) {			Toasts.toast(this, "qq号码不能为空");			return;		}		try {			num1 = Integer.parseInt(num3);		} catch (Exception e) {			Toasts.toast(this, "请输入整数");			return;		}		if (num1 <= 0) {			Toasts.toast(this, "兑换数量必须是大于0的整数");			return;		}		if (num1 > canGetMoney) {			Toasts.toast(this, "兑换数量不能超过最大兑换值");			return;		}		MyPreferences.saveString("qq", qqString);		sendData();	}	private void sendData() {				PDialog.showDialog(this, "请稍等哦", "正在处理中");		params = new RequestParams();		params.put("id", Data.userBean.getId() + "");		params.put("money", num1 * 1000 + "");		params.put("yqm", Data.userBean.getShangjia());		params.put("content", "qq号码：" + qqString + "h兑换" + num1 + "个Q币");		params.put("userName", Data.userBean.getName());			int money=(int) (num1*1000*Data.bili);		params.put("tjmoney", money+"");		HttpUtil.getHttpUtil().get(HttpUrls.addOrderP, params,				new JsonHttpResponseHandler() {					@Override					public void onFinish(String url) {						super.onFinish(url);						PDialog.hidenDialog();					}					@Override					public void onFailure(Throwable error, String content) {						super.onFailure(error, content);						Toasts.toast(SendQQOrderActivity.this, "下单失败 请检查网络");						SendQQOrderActivity.this.finish();					}					@Override					public void onSuccess(int statusCode, JSONObject response) {						super.onSuccess(statusCode, response);						try {							isOk = response.getBoolean("isok");						} catch (JSONException e) {							e.printStackTrace();							Toasts.toast(SendQQOrderActivity.this, "下单失败 请检查网络");						}						if (isOk) {							Data.userBean.setAllKeDouBi(Data.userBean									.getAllKeDouBi() - num1 * 1000);							new AlertDialogs().alert(SendQQOrderActivity.this, SendQQOrderActivity.this, "兑换成功", "下单成功了" +									" 订单在1-3个工作日内到账,您可以在用户中心查看订单状态");													} else {							Toasts.toast(SendQQOrderActivity.this, "下单失败 请检查网络");							SendQQOrderActivity.this.finish();						}					}				});	}	@Override	public void initDatas() {		qqString2 = MyPreferences.getString("qq", null);		type = getIntent().getIntExtra("type", 0);		canGetMoney = (int) (Data.userBean.getAllKeDouBi() / 1000);	}	@Override	public void initViews() {		titleTextView = (TextView) findViewById(R.id.send_order_title);		num1tEditText = (EditText) findViewById(R.id.num1);		num2tEditText = (EditText) findViewById(R.id.num2);		titleTextView.setText("您当前金币: " + Data.userBean.getAllKeDouBi()				+ " 个. 最多可以兑换 " + canGetMoney + "  个Q币，1000金币=1Q币");		if (qqString2 != null) {			num2tEditText.setText(qqString2);		}		if (!TextUtils.isEmpty(Data.userBean.getQq())) {			num2tEditText.setText(Data.userBean.getQq());		}	}	@Override	public void setListener() {	}	@Override	public void getData() {	}	@Override	public void setDate() {	}	@Override	public void doLeftButton(String value) {		// TODO Auto-generated method stub			}	@Override	public void doRightButton(String value) {		// TODO Auto-generated method stub			}	@Override	public void doSometing(String value) {		this.finish();		overridePendingTransition(R.anim.iphone1, R.anim.iphone2);			}}