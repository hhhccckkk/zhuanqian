package com.hck.getmoney.ui;import org.json.JSONException;import com.hck.getmoney.data.Data;import com.hck.getmoney.data.HttpUrls;import com.hck.getmoney.net.HCKHttpResponseHandler;import com.hck.getmoney.net.JsonHttpResponseHandler;import com.hck.getmoney.net.RequestParams;import com.hck.getmoney.util.HttpUtil;import com.hck.getmoney.widget.PDialog;import com.hck.getmoney.widget.Toasts;import com.hck.kedouzq.R;import android.app.Activity;import android.os.Bundle;import android.text.TextUtils;import android.util.Log;import android.view.View;import android.widget.EditText;public class UpdateUserInfoActivity extends Activity {	private EditText nichenEditText, phonEditText, qqEditText,			zhifubaoEditText;	private String userName, userPhone, userQQ, userZhiFuBao;	@Override	protected void onCreate(Bundle savedInstanceState) {		super.onCreate(savedInstanceState);		setContentView(R.layout.activity_update_user_info);		initView();	}	public void back(View view) {		finish();	}	private void initView() {		nichenEditText = (EditText) findViewById(R.id.user_nicheng);		phonEditText = (EditText) findViewById(R.id.user_phone);		qqEditText = (EditText) findViewById(R.id.user_qq);		zhifubaoEditText = (EditText) findViewById(R.id.user_zhifubao);		if (!TextUtils.isEmpty(Data.userBean.getName())) {			nichenEditText.setText(Data.userBean.getName());		}		if (!TextUtils.isEmpty(Data.userBean.getPhone())) {			phonEditText.setText(Data.userBean.getPhone());		}		if (!TextUtils.isEmpty(Data.userBean.getQq())) {			qqEditText.setText(Data.userBean.getQq());		}		if (!TextUtils.isEmpty(Data.userBean.getZhifubao())) {			zhifubaoEditText.setText(Data.userBean.getZhifubao());		}	}		public void updateUser(View view) {		getData();		if (checkData()) {			sendDataToServer();		}	}	private void sendDataToServer() {		PDialog.showDialog(this, "请稍等", "正在处理中");		RequestParams params = new RequestParams();		params.put("uid", Data.userBean.getId() + "");		params.put("nicheng", userName);		params.put("phone", userPhone);		params.put("qq", userQQ);		params.put("zhifubao", userZhiFuBao);		HttpUtil.getHttpUtil().get(HttpUrls.updateUserP, params,				new JsonHttpResponseHandler() {					@Override					public void onFailure(Throwable error, String content) {						super.onFailure(error, content);						Toasts.toast(UpdateUserInfoActivity.this, "修改失败 请重试");					}					public void onSuccess(int statusCode,							org.json.JSONObject response) {						if (response!=null) {							try {								boolean b=response.getBoolean("isok");								if (b) {									if (TextUtils.isEmpty(Data.userBean.getQq())) {										Data.userBean.setAllKeDouBi(Data.userBean.getAllKeDouBi()+100);										Toasts.toast(UpdateUserInfoActivity.this, "完善信息成功 金币加100");									}									else {										Toasts.toast(UpdateUserInfoActivity.this, "修改信息成功");									}									updateUser();									finish();								}								else {									Toasts.toast(UpdateUserInfoActivity.this, "修改失败 请检查网络");									}							} catch (JSONException e) {								e.printStackTrace();								Toasts.toast(UpdateUserInfoActivity.this, "修改失败 请检查网络");								}													}					};					public void onFinish(String url) {						PDialog.hidenDialog();						Log.d("hck", "url: "+url);					};				});	}   private void updateUser(){	   Data.userBean.setQq(userQQ);	   Data.userBean.setZhifubao(userZhiFuBao);	   Data.userBean.setName(userName);	   Data.userBean.setPhone(userPhone);   }	private void getData() {		userName = nichenEditText.getText().toString();		userPhone = phonEditText.getText().toString();		userQQ = qqEditText.getText().toString();		userZhiFuBao = zhifubaoEditText.getText().toString();	}	private boolean checkData() {		if (TextUtils.isEmpty(userName)) {			Toasts.toast(this, "昵称不能为空");			return false;		} else if (TextUtils.isEmpty(userPhone)) {			Toasts.toast(this, "电话号码不能为空");			return false;		} else if (TextUtils.isEmpty(userQQ)) {			Toasts.toast(this, "QQ不能为空");			return false;		} else if (TextUtils.isEmpty(userZhiFuBao)) {			Toasts.toast(this, "支付宝账号不能为空");			return false;		} else if (userName.length() < 2) {			Toasts.toast(this, "昵称不能少于2个");			return false;		} else if (userName.length() > 5) {			Toasts.toast(this, "昵称不能大于5个");			return false;		} else {			return true;		}	}}